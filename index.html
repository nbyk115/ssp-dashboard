<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ—¥æœ¬ ads.txt SSP ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹åˆ†æ</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;600;700&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}html,body{background:#fff;margin:0;}
body{color:#1a1a1a;font-family:'Noto Sans JP',sans-serif;line-height:1.65;font-size:14px;}
.wrap{max-width:1100px;margin:0 auto;padding:32px 20px 64px;background:#fff;}
.hd{margin-bottom:24px;border-bottom:2px solid #1a1a1a;padding-bottom:12px;}.hd h1{font-size:1.35rem;font-weight:700;}.hd p{font-size:.76rem;color:#777;margin-top:3px;}
.meta-row{display:flex;gap:10px;margin-top:8px;flex-wrap:wrap;font-size:.68rem;color:#aaa;}.meta-row span{background:#f7f7f7;padding:2px 8px;border-radius:4px;}
.insight{border-radius:8px;padding:16px 18px;margin-bottom:16px;font-size:.78rem;line-height:1.8;}
.insight-blue{background:#f0f7ff;border:1px solid #bfdbfe;color:#1e40af;}.insight-green{background:#f0fdf4;border:1px solid #bbf7d0;color:#166534;}.insight-amber{background:#fffbeb;border:1px solid #fde68a;color:#92400e;}
.insight h3{font-size:.88rem;font-weight:700;margin-bottom:6px;}
.score-row{display:flex;align-items:center;gap:8px;padding:3px 0;font-size:.78rem;}
.rank-num{font-family:'IBM Plex Mono',monospace;font-weight:700;font-size:1rem;width:24px;text-align:right;}.score-name{font-weight:600;min-width:150px;}
.score-bar-bg{flex:1;height:8px;background:rgba(0,0,0,.06);border-radius:4px;overflow:hidden;max-width:180px;}.score-bar-fill{height:100%;border-radius:4px;}
.score-val{font-family:'IBM Plex Mono',monospace;font-weight:600;font-size:.76rem;width:40px;text-align:right;}.score-detail{font-size:.62rem;color:inherit;opacity:.5;font-family:'IBM Plex Mono',monospace;}
.rule{font-size:.68rem;color:inherit;opacity:.6;margin-top:8px;line-height:1.7;}.jp-flag{color:#e11d48;}
.note{background:#fafafa;border-left:3px solid #ddd;padding:10px 14px;margin-bottom:20px;font-size:.74rem;color:#777;line-height:1.6;}.note strong{color:#555;}
.ctrl{display:flex;gap:6px;flex-wrap:wrap;align-items:center;margin-bottom:14px;}
.pill{padding:5px 13px;border:1px solid #ddd;border-radius:20px;font-size:.71rem;cursor:pointer;background:#fff;color:#999;font-family:'Noto Sans JP',sans-serif;transition:all .15s;white-space:nowrap;}.pill:hover{border-color:#aaa;color:#666;}.pill.on{background:#1a1a1a;color:#fff;border-color:#1a1a1a;}
.sep{width:1px;height:16px;background:#e5e5e5;margin:0 3px;}
.search{padding:5px 12px;border:1px solid #ddd;border-radius:20px;font-size:.72rem;font-family:'Noto Sans JP',sans-serif;outline:none;width:200px;color:#333;transition:border-color .15s;}.search:focus{border-color:#888;box-shadow:0 0 0 2px rgba(59,130,246,.08);}.search::placeholder{color:#ccc;}
.hit-count{font-size:.64rem;color:#3b82f6;font-weight:600;margin-left:2px;}
.legend{display:flex;gap:16px;margin-bottom:8px;font-size:.68rem;color:#aaa;}.legend span{display:flex;align-items:center;gap:4px;}.legend .ld{width:10px;height:10px;border-radius:2px;}
.vol-row{display:grid;grid-template-columns:175px 1fr 60px 80px;gap:6px;align-items:center;padding:4px 0;border-bottom:1px solid #f5f5f5;}.vol-row:hover{background:#fefefe;}
.vol-name{font-size:.76rem;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.vol-name .jp{color:#e11d48;}.vol-name .gl{color:#333;}.vol-name .dom{font-size:.58rem;color:#ccc;font-weight:400;display:block;font-family:'IBM Plex Mono',monospace;}.vol-name .co{font-size:.56rem;color:#bbb;font-weight:400;}
.bar-wrap{position:relative;height:20px;}.bar-inner{display:flex;height:100%;border-radius:3px;overflow:hidden;position:absolute;left:0;top:0;}.bar-inner .bd{background:#3b82f6;}.bar-inner .br{background:#f97316;}
.vol-total{font-size:.76rem;font-family:'IBM Plex Mono',monospace;color:#555;text-align:right;font-weight:600;}
.ratio-label{font-size:.74rem;font-family:'IBM Plex Mono',monospace;display:flex;gap:2px;align-items:center;justify-content:flex-end;}.ratio-label .d-num{color:#3b82f6;font-weight:600;}.ratio-label .sep-slash{color:#ddd;}.ratio-label .r-num{color:#f97316;font-weight:600;}
mark{background:#fde68a;color:#1a1a1a;border-radius:2px;padding:0 1px;}
.vol-header{display:grid;grid-template-columns:175px 1fr 60px 80px;gap:6px;padding:2px 0 6px;font-size:.6rem;color:#bbb;text-transform:uppercase;letter-spacing:.04em;border-bottom:1px solid #e5e5e5;margin-bottom:2px;}.vol-header span:nth-child(3){text-align:right;}.vol-header span:nth-child(4){text-align:right;}
.gcards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:8px;margin-bottom:16px;}
.gc{border:1px solid #e5e5e5;border-radius:7px;padding:10px 12px;background:#fff;}.gc .gn{font-weight:700;font-size:.82rem;display:flex;align-items:center;gap:4px;margin-bottom:3px;}.gc .gn .dot{width:6px;height:6px;border-radius:2px;}.gc .gd{font-size:.68rem;color:#888;line-height:1.5;}.gc .gd b{color:#444;font-family:'IBM Plex Mono',monospace;font-weight:500;}.gc .gm{font-size:.6rem;color:#bbb;margin-top:3px;font-family:'IBM Plex Mono',monospace;}
.sc-section{margin-bottom:32px;}.sc-section h2{font-size:1rem;font-weight:700;margin-bottom:3px;}.sc-section .desc{font-size:.72rem;color:#999;margin-bottom:8px;}
.sc-ctrl{display:flex;gap:5px;margin-bottom:8px;flex-wrap:wrap;font-size:.7rem;}
.sc-box{border:1px solid #e5e5e5;border-radius:8px;overflow:hidden;background:#fff;}
.sc-legend{display:flex;gap:14px;padding:7px 12px;font-size:.63rem;color:#bbb;border-top:1px solid #f0f0f0;flex-wrap:wrap;}.sc-legend span{display:flex;align-items:center;gap:3px;}.sc-legend .ld{width:6px;height:6px;border-radius:50%;}
.tbl-section h2{font-size:1rem;font-weight:700;margin-bottom:10px;}.tw{overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
th{text-align:left;font-size:.6rem;color:#aaa;text-transform:uppercase;letter-spacing:.04em;padding:6px 7px;border-bottom:2px solid #e5e5e5;white-space:nowrap;cursor:pointer;user-select:none;position:sticky;top:0;background:#fff;z-index:2;}
th:hover{color:#666;}th.act{color:#1a1a1a;}th.r{text-align:right;}th.c{text-align:center;}
td{padding:5px 7px;border-bottom:1px solid #f5f5f5;font-size:.76rem;}tr:hover td{background:#fcfcfc;}
td.r{text-align:right;font-family:'IBM Plex Mono',monospace;font-size:.72rem;}td.c{text-align:center;}td.nm{font-weight:600;white-space:nowrap;}
.mini-bar{display:flex;height:10px;border-radius:2px;overflow:hidden;background:#f0f0f0;}.mini-bar .bd{background:#3b82f6;height:100%;}.mini-bar .br{background:#f97316;height:100%;}
.otag{font-size:.54rem;padding:1px 4px;border-radius:3px;margin-left:2px;}.otag-JP{background:#fff1f2;color:#e11d48;}.otag-US{background:#eef2ff;color:#4f46e5;}.otag-FR{background:#f0fdf4;color:#16a34a;}.otag-UK{background:#fefce8;color:#ca8a04;}.otag-CA{background:#faf5ff;color:#9333ea;}.otag-o{background:#f7f7f7;color:#999;}
.cut-badge{font-size:.54rem;color:#999;background:#f5f5f5;padding:1px 4px;border-radius:3px;margin-left:3px;}
.ft{font-size:.6rem;color:#ccc;margin-top:24px;line-height:1.8;border-top:1px solid #f0f0f0;padding-top:12px;}
.partner-badge{display:inline-block;font-size:.52rem;background:linear-gradient(135deg,#10b981,#059669);color:white;padding:1px 5px;border-radius:3px;margin-left:5px;font-weight:600;letter-spacing:.3px;vertical-align:middle;}.partner-row{background:linear-gradient(90deg,rgba(16,185,129,.04),transparent)!important;border-left:3px solid #10b981!important;}
.cat-tag{display:inline-block;font-size:.48rem;padding:1px 4px;border-radius:2px;margin-left:4px;font-weight:600;letter-spacing:.2px;vertical-align:middle;border:1px solid;}.cat-ssp{color:#6366f1;border-color:#c7d2fe;background:#eef2ff;}.cat-hb{color:#d97706;border-color:#fde68a;background:#fffbeb;}.cat-other{color:#999;border-color:#e5e5e5;background:#fafafa;}
.tooltip{position:fixed;max-width:340px;background:#1a1a1a;color:#eee;padding:10px 14px;border-radius:8px;font-size:.72rem;line-height:1.6;pointer-events:none;z-index:100;box-shadow:0 4px 20px rgba(0,0,0,.25);opacity:0;transition:opacity .15s;}.tooltip.vis{opacity:1;}.tooltip .tt-name{font-weight:700;font-size:.82rem;margin-bottom:3px;color:#fff;}.tooltip .tt-meta{font-size:.64rem;color:#999;margin-bottom:4px;}.tooltip .tt-desc{color:#ccc;}
@media(max-width:768px){.vol-row,.vol-header{grid-template-columns:130px 1fr 50px 70px;}}
</style>
</head>
<body>
<div class="wrap">
  <div class="hd">
    <h1>æ—¥æœ¬ ads.txt SSP ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹åˆ†æ</h1>
    <p>æ—¥æœ¬ã®ä¸»è¦ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã®ads.txtã‹ã‚‰ã€æ—¥æœ¬å¸‚å ´ã§èªçŸ¥åº¦ã®é«˜ã„SSPã«çµã‚Šã€è¦æ¨¡ã¨ã‚µãƒ—ãƒ©ã‚¤ãƒ‘ã‚¹æ§‹é€ ã‚’å¯è¦–åŒ–</p>
    <div class="meta-row"><span>Potential Impressionsä¸Šä½200ã‚µã‚¤ãƒˆã‹ã‚‰æ³•äººãƒ¡ãƒ‡ã‚£ã‚¢115ã‚µã‚¤ãƒˆã«çµã‚Šads.txtå–å¾—</span><span>ä¸»è¦17ç¤¾ï¼ˆGoogle AdXãƒ»APSãƒ»Criteoãƒ»Outbrain/Taboolaãƒ»åšå ±å ‚DYç³»ãƒ»FreakOuté™¤å¤–ï¼‰</span><span>2026-02-18 ã‚¯ãƒ­ãƒ¼ãƒ« / imp 2/10ã€œ16</span></div>
  </div>
  <div class="insight insight-amber">
    <h3>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨é™¤å¤–ã«ã¤ã„ã¦</h3>
    <strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹:</strong> Potential Impressionsï¼ˆæ¨å®šè¡¨ç¤ºå›æ•°ï¼‰ãƒ™ãƒ¼ã‚¹ã®æ—¥æœ¬ã‚µã‚¤ãƒˆä¸Šä½200ã‚µã‚¤ãƒˆã®ã†ã¡ã€<strong>æ³•äººé‹å–¶ã®ç·¨é›†ãƒ¡ãƒ‡ã‚£ã‚¢115ã‚µã‚¤ãƒˆ</strong>ã«çµã£ã¦ads.txtã‚’å–å¾—ã€‚UGC/å€‹äººãƒ–ãƒ­ã‚°ã€ã‚²ãƒ¼ãƒ æ”»ç•¥wikiã€MFAç–‘ã„ã‚µã‚¤ãƒˆã€ãƒ„ãƒ¼ãƒ«ç³»ã¯é™¤å¤–ã€‚æ–°èç¤¾ãƒ»TVå±€ãƒ»å‡ºç‰ˆç¤¾ç³»Webãƒ¡ãƒ‡ã‚£ã‚¢ãƒ»å¤§æ‰‹ãƒãƒ¼ã‚¿ãƒ«ãŒä¸­å¿ƒã€‚ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°ã¯2026å¹´2æœˆ10ã€œ16æ—¥ã®æœŸé–“ãƒ‡ãƒ¼ã‚¿ã€‚<br>
    <strong>ã‚µã‚¤ãƒˆçµã‚Šè¾¼ã¿ã®ç†ç”±:</strong> ã€Œãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã€ã®æ¥­ç•Œçµ±ä¸€å®šç¾©ã¯å­˜åœ¨ã—ãªã„ãŒã€SSPè©•ä¾¡ã®æ–‡è„ˆã§ã¯<strong>æ³•äººé‹å–¶Ã—ç·¨é›†ã‚³ãƒ³ãƒ†ãƒ³ãƒ„Ã—ãƒ–ãƒ©ãƒ³ãƒ‰ã‚»ãƒ¼ãƒ•</strong>ãªåœ¨åº«ãŒå¯¾è±¡ã€‚å€‹äººãƒ–ãƒ­ã‚°ã‚„MFAã‚µã‚¤ãƒˆã®ads.txtã‚¨ãƒ³ãƒˆãƒªã‚’å«ã‚ã‚‹ã¨ãƒªã‚»ãƒ©ãƒ¼ãƒ‘ã‚¹ãŒè†¨å¼µã—ã€å®Ÿæ…‹ã¨ä¹–é›¢ã—ãŸSSPè©•ä¾¡ã«ãªã‚‹ã€‚<br>
    <strong>SSPé™¤å¤–ï¼ˆ5ç¤¾ï¼‰:</strong><br>
    &nbsp;&nbsp;â— <strong>Criteo</strong> â€” Commerce Grid = è‡ªç¤¾DSPãƒ‡ãƒãƒ³ãƒ‰ãŒå„ªä½ã€‚TTD/DV360ã‹ã‚‰CriteoçµŒç”±ã§è²·ä»˜ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆãŒè–„ã„ï¼ˆå‚è€ƒ: 1,554ãƒ‘ã‚¹/D48%/110ã‚µã‚¤ãƒˆï¼‰<br>
    &nbsp;&nbsp;â— <strong>Outbrainãƒ»Taboola</strong> â€” ãƒã‚¤ãƒ†ã‚£ãƒ–ADNWã€‚ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãªãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ãƒ‡ãƒãƒ³ãƒ‰æ§‹é€ ã§ã€ã‚ªãƒ¼ãƒ—ãƒ³ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³å‹SSPã¨åŒåˆ—æ¯”è¼ƒä¸é©åˆ‡ï¼ˆå‚è€ƒ: Outbrain 890ãƒ‘ã‚¹/D36%, Taboola 335ãƒ‘ã‚¹/D84%ï¼‰<br>
    &nbsp;&nbsp;â— <strong>DAC/adingoãƒ»YieldOne</strong> â€” åšå ±å ‚DYã‚°ãƒ«ãƒ¼ãƒ—SSPã€‚ã‚°ãƒ«ãƒ¼ãƒ—å†…ãƒ¡ãƒ‡ã‚£ã‚¢ã¨ã®ç›´æ¥æ¥ç¶šã§Dç‡ãŒæ§‹é€ çš„ã«é«˜ããªã‚‹ã€‚é›»é€šã‚°ãƒ«ãƒ¼ãƒ—è¦–ç‚¹ã§ã¯SSPæ¨å¥¨å¯¾è±¡ã¨ã—ã¦ä¸é©åˆ‡ï¼ˆå‚è€ƒ: adingo 1,778ãƒ‘ã‚¹/D39%/114ã‚µã‚¤ãƒˆ, YieldOne 2,143ãƒ‘ã‚¹/D20%/112ã‚µã‚¤ãƒˆï¼‰<br>
    <strong>ãã®ä»–é™¤å¤–:</strong> Google AdXï¼ˆgoogle.comï¼‰ã¯10,311ãƒ‘ã‚¹ / å…¨115ã‚µã‚¤ãƒˆã§æ¡é•ã„ã®ãŸã‚åˆ¥é›†è¨ˆã€‚Amazon APSï¼ˆTAM/UAMï¼‰ã¯Amazon DSPãƒ‡ãƒãƒ³ãƒ‰ãŒå„ªä½ã«åƒãæ§‹é€ ã®ãŸã‚é™¤å¤–ã€‚
  </div>
  <div class="insight insight-blue" id="spo-box"></div>
  <div class="insight insight-green" id="jp-box"></div>
  <div class="note">
    <strong>ã€Œãƒ‘ã‚¹æ•°ã€ã¨ã¯ï¼š</strong>å„ã‚µã‚¤ãƒˆã®ads.txtï¼ˆåºƒå‘Šè²©å£²è¨±å¯ãƒªã‚¹ãƒˆï¼‰ã«è¨˜è¼‰ã•ã‚ŒãŸã€<strong>ã€Œã“ã®SSPçµŒç”±ã§åºƒå‘Šã‚’å£²ã£ã¦OKã€ã¨ã„ã†è¨±å¯ã®è¡Œæ•°</strong>ã€‚1ã‚µã‚¤ãƒˆã«ã¤ãè¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»çµŒè·¯ãŒã‚ã‚‹ãŸã‚ã€115ã‚µã‚¤ãƒˆåˆ†ã‚’åˆè¨ˆã™ã‚‹ã¨æ•°åƒã€œæ•°ä¸‡ã«ãªã‚‹ã€‚ãƒ‘ã‚¹æ•°ãŒå¤šã„ï¼å¤šãã®ã‚µã‚¤ãƒˆãŒå¤šãã®çµŒè·¯ã§ãã®SSPã‚’è¨±å¯ã—ã¦ã„ã‚‹ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚„ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³æ•°ã¨ã¯ç•°ãªã‚‹ã€‚
  </div>
  <div id="app"></div>
  <div class="tooltip" id="tip"><div class="tt-name"></div><div class="tt-meta"></div><div class="tt-desc"></div></div>
</div>
<script>
const TH=1000,TS=115,fmt=n=>n.toLocaleString();
const PARTNERS={"media.net":{reason:"ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆSSPã€‚HBçµŒç”±ã§TTD/DV360ã‹ã‚‰ç›´æ¥è²·ä»˜å¯èƒ½ã€‚Dç‡38%ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«SSPä¸­æœ€é«˜æ°´æº–ã€‚ç‹¬è‡ªã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒæŠ€è¡“ã§Cookieãƒ¬ã‚¹ç’°å¢ƒã«å¼·ã¿ã€‚"},"ad-stir.com":{reason:"é›»é€šã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆCARTA HDï¼‰ã®é…ä¿¡ç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚å›½å†…ãƒ—ãƒ¬ãƒŸã‚¢ãƒ 109ã‚µã‚¤ãƒˆã«å°å…¥ã€‚æ—¥æœ¬èªãƒ•ãƒ«ã‚µãƒãƒ¼ãƒˆãƒ»å›½å†…ãƒ¡ãƒ‡ã‚£ã‚¢ã¨ã®æ·±ã„æ¥ç¶šå®Ÿç¸¾ã€‚ãƒªã‚»ãƒ©ãƒ¼æ§‹é€ ä¸Šã€åœ¨åº«åˆ°é”ç¯„å›²ã¯å¤§æ‰‹æµ·å¤–SSPã¨é‡è¤‡ã™ã‚‹ãŒã€æ—¥æœ¬å¸‚å ´ã«ç‰¹åŒ–ã—ãŸé‹ç”¨æ”¯æ´ãƒ»ãƒ¬ãƒãƒ¼ãƒˆãƒ»Dealè¨­è¨ˆãŒå¼·ã¿ã€‚"},"ogury.com":{reason:"Consent-basedåºƒå‘Šã§å·®åˆ¥åŒ–ã™ã‚‹ãƒ¢ãƒã‚¤ãƒ«ç‰¹åŒ–SSPã€‚110ã‚µã‚¤ãƒˆã«æ²è¼‰ã€‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¦åˆ¶å¼·åŒ–ã«å¯¾å¿œã—ãŸCookieãƒ¬ã‚¹åºƒå‘Šã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã€‚"}};
// Category: "ssp" = SSP/Exchange, "hb" = é…ä¿¡ç®¡ç†/ãƒ¡ãƒ‡ã‚£ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³/ADNW
const CAT={
  "pubmatic.com":"ssp","rubiconproject.com":"ssp","openx.com":"ssp","indexexchange.com":"ssp",
  "smartadserver.com":"ssp","video.unrulymedia.com":"ssp","inmobi.com":"ssp","media.net":"ssp",
  "gumgum.com":"ssp","teads.tv":"ssp","microad.co.jp":"ssp","ogury.com":"ssp","genieesspv.jp":"ssp",
  "ad-stir.com":"hb","ad-generation.jp":"hb","i-mobile.co.jp":"hb","aja.vision":"hb"
};
const CAT_LABEL={"ssp":"SSP","hb":"é…ä¿¡ç®¡ç†","other":"å‚è€ƒ"};
const CAT_COLOR={"ssp":"#6366f1","hb":"#f59e0b","other":"#aaa"};
const sspDesc={
  "pubmatic.com":"ã‚°ãƒ­ãƒ¼ãƒãƒ«æœ€å¤§ç´šã®SSPã€‚TTD/DV360/Amazon DSPã™ã¹ã¦ã‹ã‚‰æ¨™æº–æ¥ç¶šæ¸ˆã¿ã€‚ã‚ãˆã¦æ¨å¥¨ã™ã‚‹å¿…è¦ãŒãªã„ï¼ˆã©ã®DSPã‹ã‚‰ã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§åˆ©ç”¨å¯èƒ½ï¼‰ã€‚æ—¥æœ¬ã§ã¯Dç‡7%ï¼ã»ã¼å…¨ãƒ‘ã‚¹ãŒãƒªã‚»ãƒ©ãƒ¼çµŒç”±ã§ã€ä»–SSPã¨åœ¨åº«ãŒå¤§å¹…ã«é‡è¤‡ã™ã‚‹ã€‚",
  "rubiconproject.com":"æ—§Rubicon Project â†’ Magniteã€‚CTV/OTTã«å¼·ã¿ã€‚TTD/DV360ã‹ã‚‰æ¨™æº–æ¥ç¶šæ¸ˆã¿ã€‚æ—¥æœ¬ã§ã¯Dç‡11%ï¼ãƒªã‚»ãƒ©ãƒ¼ä¸»ä½“ã§ã€PubMaticç­‰ã¨åœ¨åº«ãŒé‡è¤‡ã€‚CTVé ˜åŸŸã§ã¯å·®åˆ¥åŒ–ã‚ã‚‹ãŒWebé¢ã§ã¯çµŒè·¯ä¸Šã®å„ªä½æ€§ã¯è–„ã„ã€‚",
  "openx.com":"è€èˆ—SSPã€‚TTD/DV360ã‹ã‚‰æ¨™æº–æ¥ç¶šæ¸ˆã¿ã€‚æ—¥æœ¬ã§ã¯Dç‡6%ï¼ã»ã¼å…¨ãƒ‘ã‚¹ãŒãƒªã‚»ãƒ©ãƒ¼çµŒç”±ã€‚OpenAudienceï¼ˆç‹¬è‡ªIDï¼‰ã«å¼·ã¿ãŒã‚ã‚‹ãŒã€Webé¢ã®çµŒè·¯æ§‹é€ ã§ã¯ä»–å¤§æ‰‹SSPã¨ã®å·®åˆ¥åŒ–ãŒé›£ã—ã„ã€‚",
  "indexexchange.com":"ã‚«ãƒŠãƒ€ç™ºSSP/Exchangeã€‚é€æ˜æ€§é‡è¦–ã®çµŒè·¯è¨­è¨ˆã€‚TTD/DV360ã‹ã‚‰æ¨™æº–æ¥ç¶šæ¸ˆã¿ã€‚æ—¥æœ¬ã§ã¯Dç‡9%ï¼ãƒªã‚»ãƒ©ãƒ¼ä¸»ä½“ã€‚çµŒè·¯ã®é€æ˜æ€§ã«ã¯å®šè©•ãŒã‚ã‚‹ãŒã€åœ¨åº«åˆ°é”ç¯„å›²ã¯PubMaticç­‰ã¨å¤§éƒ¨åˆ†é‡è¤‡ã€‚",
  "smartadserver.com":"ä»Equativï¼ˆæ—§SmartAdServerï¼‰ã€‚æ¬§å·ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã«å¼·ã„ã€‚ã‚­ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‹SSPã€‚",
  "video.unrulymedia.com":"æ—§Unruly â†’ Nexxençµ±åˆã€‚å‹•ç”»SSPã¨ã—ã¦å‡ºç™ºã€CTV/OTTã«å±•é–‹ã€‚",
  "inmobi.com":"ã‚¤ãƒ³ãƒ‰ç™ºãƒ¢ãƒã‚¤ãƒ«ç‰¹åŒ–SSPã€‚ã‚¢ãƒ—ãƒªé¢ã«å¼·ã¿ãŒã‚ã‚‹ãŒæ—¥æœ¬ã§ã¯ãƒ¢ãƒã‚¤ãƒ«Webã§ã‚‚å±•é–‹ã€‚",
  "media.net":"Yahoo!/Bingã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒæŠ€è¡“ã‚’æŒã¤SSPã€‚HBãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ç€å®Ÿã«ã‚·ã‚§ã‚¢æ‹¡å¤§ã€‚Dç‡38%ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«SSPã®ä¸­ã§é«˜æ°´æº–ã€‚",
  "gumgum.com":"ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåºƒå‘Šç‰¹åŒ–SSPã€‚ãƒšãƒ¼ã‚¸å†…å®¹ã‚’AIè§£æã—ã¦åºƒå‘Šé…ä¿¡ã€‚Cookieãƒ¬ã‚¹å¯¾å¿œã§æ³¨ç›®åº¦ä¸Šæ˜‡ä¸­ã€‚âš  CPMã¯ä»–SSPæ¯”ã§é«˜ã‚ï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¿ãƒ¼ã‚²ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¾¡æ ¼ï¼‰ã€‚ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ¡ˆä»¶å‘ãã€‚",
  "teads.tv":"ä»ç™ºã‚¤ãƒ³ãƒªãƒ¼ãƒ‰å‹•ç”»SSPã€‚è¨˜äº‹ä¸­å‹•ç”»åºƒå‘Šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§å·®åˆ¥åŒ–ã€‚110/115ã‚µã‚¤ãƒˆã«DIRECTæ¥ç¶šï¼ˆDç‡59%ï¼‰ã€‚ãƒ‘ã‚¹æ•°ã¯å°‘ãªã„ãŒæ²è¼‰ç‡94%ã€‚âš  CPMã¯ä»–SSPæ¯”ã§é«˜ã‚ï¼ˆå‹•ç”»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç‰¹æ€§ï¼‰ã€‚ã‚³ã‚¹ãƒˆåŠ¹ç‡ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯æ³¨æ„ã€‚",
  "i-mobile.co.jp":"ã‚¢ã‚¤ãƒ¢ãƒã‚¤ãƒ«ã€‚å›½ç”£ADNW/SSPã€‚RESELLERæ¯”ç‡é«˜ããƒªã‚»ãƒ©ãƒ¼ãƒãƒ–çš„å½¹å‰²ã€‚ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆäº‹æ¥­ã‚‚å±•é–‹ã€‚",
  "ad-stir.com":"fluctï¼ˆCARTA HD / é›»é€šã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ã€‚å›½å†…æœ€å¤§ç´šã®é…ä¿¡ç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚109ã‚µã‚¤ãƒˆã«å°å…¥ã€‚DIRECTç‡ã¯ä½ã„ãŒã€ã“ã‚Œã¯SSPã‚’ã¾ã¨ã‚ã‚‹å½¹å‰²ã®ãŸã‚ï¼ˆå“è³ªã®å•é¡Œã§ã¯ãªã„ï¼‰ã€‚åœ¨åº«åˆ°é”ç¯„å›²ã¯PubMaticç­‰ã¨å¤§éƒ¨åˆ†é‡è¤‡ã™ã‚‹ãŒã€æ—¥æœ¬å¸‚å ´ç‰¹åŒ–ã®é‹ç”¨æ”¯æ´ãƒ»Dealè¨­è¨ˆãƒ»æ—¥æœ¬èªãƒ¬ãƒãƒ¼ãƒˆãŒå·®åˆ¥åŒ–è¦å› ã€‚",
  "ad-generation.jp":"Supershipï¼ˆKDDIç³»ï¼‰ã®å›½ç”£SSPã€‚ã‚¢ãƒ—ãƒªãƒ»ãƒ¢ãƒã‚¤ãƒ«Webå‘ã‘ãƒ¡ãƒ‡ã‚£ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€‚",
  "genieesspv.jp":"ã‚¸ãƒ¼ãƒ‹ãƒ¼ã€‚å›½ç”£SSPã€‚ç‹¬è‡ªHBã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å±•é–‹ã€‚ä¸­å°ãƒ¡ãƒ‡ã‚£ã‚¢ã¸ã®å°å…¥ãŒå¤šã„ã€‚",
  "microad.co.jp":"ãƒã‚¤ã‚¯ãƒ­ã‚¢ãƒ‰ã€‚å›½ç”£SSP/DMPã€‚UNIVERSEãƒ‡ãƒ¼ã‚¿é€£æºãŒç‰¹å¾´ã€‚è¦æ¨¡å°ã ãŒç›´æ¥å¥‘ç´„ç‡é«˜ã€‚",
  "aja.vision":"ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆSSPã€‚ABEMAç­‰CTVåœ¨åº«ã§çŸ¥ååº¦ãŒé«˜ã„ãŒã€Webé¢ã¯104ã‚µã‚¤ãƒˆä¸­93%ãŒRESELLERã€‚CTVåœ¨åº«ã¯ads.txtå¯¾è±¡å¤–ã®ãŸã‚æœ¬åˆ†æã«ã¯å«ã¾ã‚Œãªã„ã€‚",
  "ogury.com":"ä»ç™ºãƒ¢ãƒã‚¤ãƒ«ç‰¹åŒ–SSPã€‚Consent-basedï¼ˆåŒæ„ãƒ™ãƒ¼ã‚¹ï¼‰åºƒå‘Šã‚’æ²ã’ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¦åˆ¶ã¸ã®å¯¾å¿œåŠ›ãŒå¼·ã¿ã€‚110/115ã‚µã‚¤ãƒˆã«æ²è¼‰ã€‚Dç‡37%ã€‚",
};
const raw=[
  {n:"pubmatic.com",d:1556,r:18126,t:19682,s:115,brand:"PubMatic",co:"",o:"US"},
  {n:"rubiconproject.com",d:1275,r:12039,t:13314,s:115,brand:"Magnite",co:"æ—§Rubicon Project",o:"US"},
  {n:"openx.com",d:624,r:9029,t:9653,s:115,brand:"OpenX",co:"",o:"US"},
  {n:"indexexchange.com",d:692,r:6481,t:7173,s:115,brand:"Index Exchange",co:"",o:"CA"},
  {n:"smartadserver.com",d:776,r:5306,t:6082,s:114,brand:"Equativ",co:"æ—§SmartAdServer",o:"FR"},
  {n:"video.unrulymedia.com",d:670,r:3389,t:4059,s:111,brand:"Nexxen",co:"æ—§Unruly",o:"UK"},
  {n:"inmobi.com",d:270,r:1441,t:1711,s:105,brand:"InMobi",co:"ãƒ¢ãƒã‚¤ãƒ«SSP",o:"IN"},
  {n:"media.net",d:589,r:961,t:1550,s:110,brand:"Media.net",co:"ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆSSP",o:"AE"},
  {n:"i-mobile.co.jp",d:37,r:1446,t:1483,s:105,brand:"i-mobile",co:"ADNW/SSP",o:"JP"},
  {n:"ad-generation.jp",d:230,r:930,t:1160,s:109,brand:"Ad Generation",co:"Supership / KDDIç³»",o:"JP"},
  {n:"ad-stir.com",d:28,r:1013,t:1041,s:109,brand:"fluct",co:"CARTA HD / é›»é€šã‚°ãƒ«ãƒ¼ãƒ—",o:"JP"},
  {n:"gumgum.com",d:221,r:818,t:1039,s:112,brand:"GumGum",co:"ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåºƒå‘Šï¼ˆSSPï¼‰",o:"US"},
  {n:"teads.tv",d:387,r:273,t:660,s:110,brand:"Teads",co:"ã‚¤ãƒ³ãƒªãƒ¼ãƒ‰å‹•ç”»ï¼ˆSSPï¼‰",o:"FR"},
  {n:"genieesspv.jp",d:208,r:255,t:463,s:94,brand:"Geniee SSP",co:"SSP",o:"JP"},
  {n:"microad.co.jp",d:210,r:218,t:428,s:107,brand:"MicroAd COMPASS",co:"SSP/DMP",o:"JP"},
  {n:"aja.vision",d:36,r:317,t:353,s:104,brand:"AJA SSP",co:"ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆSSPï¼‰",o:"JP"},
  {n:"ogury.com",d:109,r:186,t:295,s:110,brand:"Ogury",co:"ãƒ¢ãƒã‚¤ãƒ«ç‰¹åŒ–ï¼ˆSSPï¼‰",o:"FR"},
];
const grps={};
const maxT=Math.max(...raw.filter(x=>x.t>=TH).map(x=>x.t));
const tipEl=document.getElementById('tip');
function showTip(e,s){
  const desc=sspDesc[s.n]||'';if(!desc)return;
  const dp=(s.d/s.t*100).toFixed(0),sc=spoScore(s);
  tipEl.querySelector('.tt-name').textContent=s.brand+(s.co?' â€” '+s.co:'');
  tipEl.querySelector('.tt-meta').textContent=`${fmt(s.t)}ãƒ‘ã‚¹ / D${dp}% / ${s.s}ã‚µã‚¤ãƒˆ`+(sc!==null?' / è©•ä¾¡ '+sc.toFixed(1):'');
  const pInfo=PARTNERS[s.n];tipEl.querySelector('.tt-desc').textContent=pInfo?'ã€æ¨å¥¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‘'+pInfo.reason+'\n\n'+desc:desc;
  tipEl.classList.add('vis');
  const x=Math.min(e.clientX+12,window.innerWidth-360),y=e.clientY+16;
  tipEl.style.left=x+'px';tipEl.style.top=y+'px';
}
function moveTip(e){
  const x=Math.min(e.clientX+12,window.innerWidth-360),y=e.clientY+16;
  tipEl.style.left=x+'px';tipEl.style.top=y+'px';
}
function hideTip(){tipEl.classList.remove('vis');}
// SSPè©•ä¾¡ã‚¹ã‚³ã‚¢ = CovÃ—30% + D-rateÃ—35% + (Scale Ã— D-rate/100)Ã—35%  â€»SSPã‚«ãƒ†ã‚´ãƒªã®ã¿
// é…ä¿¡ç®¡ç†ã¯ã€Œå°å…¥ç‡ã€ã§è©•ä¾¡ï¼ˆDç‡ã¯ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ä¸Šæ§‹é€ çš„ã«ä½ããªã‚‹ãŸã‚ï¼‰
function spoScore(s){
  if(CAT[s.n]==='hb') return null;
  if(s.t<TH)return null;
  const dr=s.d/s.t*100, cov=s.s/TS*100, vol=Math.log(s.t)/Math.log(maxT)*100;
  return cov*.30 + dr*.35 + (vol*(dr/100))*.35;
}
function hbScore(s){
  if(CAT[s.n]!=='hb') return null;
  return s.s/TS*100;
}
function isCut(s){return CAT[s.n]==='ssp' && s.t<TH;}
function isPartner(s){return !!PARTNERS[s.n];}
function catTag(s){const c=CAT[s.n]||'other';return '<span class="cat-tag cat-'+c+'">'+CAT_LABEL[c]+'</span>';}

function renderInsightBoxes(){
  const sspOnly=raw.filter(x=>CAT[x.n]==='ssp'&&x.t>=TH).map(s=>({...s,spo:spoScore(s)})).sort((a,b)=>b.spo-a.spo);
  const hbOnly=raw.filter(x=>CAT[x.n]==='hb').map(s=>({...s,hbs:hbScore(s)})).sort((a,b)=>b.hbs-a.hbs);
  const jp=sspOnly.filter(x=>x.o==='JP'),top5=sspOnly.slice(0,5),mx=top5[0]?top5[0].spo:1;
  const cutList=raw.filter(x=>CAT[x.n]==='ssp'&&x.t<TH);
  const row=(i,s,color)=>`<div class="score-row"><span class="rank-num">${i+1}</span><span class="score-name">${s.o==='JP'?'<span class="jp-flag">ğŸ‡¯ğŸ‡µ</span> ':''}${s.brand}${PARTNERS[s.n]?' <span class="partner-badge">æ¨å¥¨</span>':''}</span><div class="score-bar-bg"><div class="score-bar-fill" style="width:${Math.round(s.spo/mx*100)}%;background:${color}"></div></div><span class="score-val">${s.spo.toFixed(1)}</span><span class="score-detail">D${(s.d/s.t*100).toFixed(0)}% Cov${(s.s/TS*100).toFixed(0)}% ${fmt(s.t)}ãƒ‘ã‚¹</span></div>`;
  const hbRow=(i,s)=>`<div class="score-row"><span class="rank-num">${i+1}</span><span class="score-name">${s.o==='JP'?'<span class="jp-flag">ğŸ‡¯ğŸ‡µ</span> ':''}${s.brand}${PARTNERS[s.n]?' <span class="partner-badge">æ¨å¥¨</span>':''}</span><div class="score-bar-bg"><div class="score-bar-fill" style="width:${Math.round(s.hbs)}%;background:#f59e0b"></div></div><span class="score-val">å°å…¥${Math.round(s.hbs)}%</span><span class="score-detail">${fmt(s.t)}ãƒ‘ã‚¹ D${(s.d/s.t*100).toFixed(0)}%</span></div>`;
  document.getElementById('spo-box').innerHTML=`
    <h3>ğŸ† SSPè©•ä¾¡ã‚¹ã‚³ã‚¢ TOP5</h3>
    ${top5.map((s,i)=>row(i,s,'#6366f1')).join('')}
    <div class="rule">SSP = ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã¨ç›´æ¥æ¥ç¶šã—ã¦DSPã«ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã‚’ä¾›çµ¦ã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€‚SSPè©•ä¾¡ã‚¹ã‚³ã‚¢ï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸30%ï¼‹DIRECTç‡35%ï¼‹ã‚¹ã‚±ãƒ¼ãƒ«Ã—Dç‡35%ï¼‰ã§è©•ä¾¡ã€‚åºƒå‘ŠãŒå±ŠãçµŒè·¯ã®ã€Œç›´æ¥æ€§ã€ã¨ã€Œç¶²ç¾…æ€§ã€ã‚’æ•°å€¤åŒ–ã—ãŸã‚‚ã®ã€‚<br><br><strong>ãªãœä¸Šä½ã®å¤§æ‰‹SSPï¼ˆPubMaticç­‰ï¼‰ãŒã€Œæ¨å¥¨ã€ã§ã¯ãªã„ã®ã‹ï¼š</strong>PubMaticãƒ»Magniteãƒ»OpenXãƒ»Index Exchangeã¯<strong>TTD/DV360/Amazon DSPã™ã¹ã¦ã§æ¨™æº–æ¥ç¶šæ¸ˆã¿</strong>ã€‚ã‚ãˆã¦æ¨å¥¨ã™ã‚‹ã¾ã§ã‚‚ãªããƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§åˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã€‚ã¾ãŸæ—¥æœ¬ã§ã¯Dç‡6ã€œ11%ï¼ã»ã¼ãƒªã‚»ãƒ©ãƒ¼çµŒç”±ã§ã€SSPé–“ã§åœ¨åº«ãŒå¤§å¹…ã«é‡è¤‡ã—ã¦ãŠã‚ŠçµŒè·¯ä¸Šã®å·®åˆ¥åŒ–ãŒé›£ã—ã„ã€‚<br>æ¨å¥¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ï¼ˆMedia.net / fluct / Oguryï¼‰ã¯ã€Œæ¨™æº–æ¥ç¶šã§ã¯å¾—ã‚‰ã‚Œãªã„å›ºæœ‰ã®ä¾¡å€¤ã€ã‚’æŒã¤SSPã€‚</div>`;
  document.getElementById('jp-box').innerHTML=`
    <h3>ğŸ“¦ é…ä¿¡ç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </h3>
    ${hbOnly.map((s,i)=>hbRow(i,s)).join('')}
    <div class="rule">ãƒ¡ãƒ‡ã‚£ã‚¢å´ã§è¤‡æ•°SSPã¸ã®æ¥ç¶šã‚’ä¸€æ‹¬ç®¡ç†ã™ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚SSPãã®ã‚‚ã®ã§ã¯ãªã<strong>SSPã‚’ã¾ã¨ã‚ã‚‹å½¹å‰²</strong>ã€‚ä»–SSPçµŒç”±ã®çµŒè·¯ãŒå¤šã„ãŸã‚ãƒªã‚»ãƒ©ãƒ¼æ¯”ç‡ãŒé«˜ããªã‚‹æ§‹é€ ï¼ˆ<strong>å“è³ªã®å•é¡Œã§ã¯ãªã„</strong>ï¼‰ã€‚ã€Œå°å…¥ç‡ã€ï¼ˆ115ã‚µã‚¤ãƒˆä¸­ã®æ²è¼‰æ•°ï¼‰ã§è©•ä¾¡ã€‚</div>`;
}
renderInsightBoxes();

let filter='all',searchQ='',showGrp=false,scFilter='all',tblSort='t',tblDir=-1;
function mq(s){if(!searchQ)return true;const q=searchQ.toLowerCase();return s.n.toLowerCase().includes(q)||s.brand.toLowerCase().includes(q)||(s.co&&s.co.toLowerCase().includes(q));}
function hlT(t){if(!searchQ)return t;const q=searchQ.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');return t.replace(new RegExp('('+q+')','gi'),'<mark>$1</mark>');}

function render(){
  let data=searchQ?raw.filter(mq):filter==='all'?raw:filter==='jp'?raw.filter(x=>x.o==='JP'):raw.filter(x=>x.o!=='JP');
  const sorted=[...data].sort((a,b)=>{if(tblSort==='spo'){const sa=spoScore(a)||hbScore(a)||0,sb=spoScore(b)||hbScore(b)||0;return tblDir*(sb-sa);}if(tblSort==='dpct')return tblDir*((b.d/b.t)-(a.d/a.t));return tblDir*((b[tblSort]||0)-(a[tblSort]||0));});
  const dmax=Math.max(...sorted.map(x=>x.t),1),hasQ=!!searchQ;
  let scData=raw.filter(x=>!isCut(x)||isPartner(x));if(scFilter==='jp')scData=scData.filter(x=>x.o==='JP');else if(scFilter==='gl')scData=scData.filter(x=>x.o!=='JP');
  const qualified=scData.filter(x=>CAT[x.n]==='ssp'&&x.t>=TH),scByScore=[...qualified].sort((a,b)=>spoScore(b)-spoScore(a));
  const top5ids=new Set(),top3ids=new Set();
  let gt={};if(showGrp){for(let[gn,gv]of Object.entries(grps)){let ms=raw.filter(x=>gv.m.includes(x.n));if(ms.length>=2)gt[gn]={d:ms.reduce((s,m)=>s+m.d,0),r:ms.reduce((s,m)=>s+m.r,0),t:ms.reduce((s,m)=>s+m.t,0),s:Math.max(...ms.map(m=>m.s)),cnt:ms.length,ms:ms.map(m=>`${m.brand} (${m.n})`)};}}
  const th=(k,l,c='')=>`<th class="${c} ${tblSort===k?'act':''}" onclick="doSort('${k}')">${l}${tblSort===k?(tblDir===-1?' â†“':' â†‘'):''}</th>`;
  document.getElementById('app').innerHTML=`
    <div class="ctrl">
      <input type="text" class="search" id="si" placeholder="æ¤œç´¢ï¼ˆå…¨${raw.length}ç¤¾ï¼‰" oninput="doSearch(this.value)"/>${hasQ?`<span class="hit-count">${sorted.length}ä»¶</span>`:''}<div class="sep"></div>
      <button class="pill ${filter==='all'&&!hasQ?'on':''}" onclick="setF('all')">ã™ã¹ã¦ (${raw.length})</button>
      <button class="pill ${filter==='jp'&&!hasQ?'on':''}" onclick="setF('jp')">å›½ç”£ (${raw.filter(x=>x.o==='JP').length})</button>
      <button class="pill ${filter==='gl'&&!hasQ?'on':''}" onclick="setF('gl')">æµ·å¤– (${raw.filter(x=>x.o!=='JP').length})</button>
      <div class="sep"></div><button class="pill ${showGrp?'on':''}" onclick="tgGrp()">ã‚°ãƒ«ãƒ¼ãƒ—åˆç®—</button>
    </div>
    ${showGrp?renderGC(gt):''}
    <div style="margin-bottom:32px;">
      <h2 style="font-size:1.05rem;font-weight:700;margin-bottom:10px;">ã‚µãƒ—ãƒ©ã‚¤ãƒ‘ã‚¹æ•° Ã— DIRECT / RESELLERæ§‹æˆ</h2>
      <div class="legend"><span><div class="ld" style="background:#3b82f6"></div>DIRECT</span><span><div class="ld" style="background:#f97316"></div>RESELLER</span></div>
      <div class="vol-header"><span>SSPå</span><span>æ§‹æˆãƒãƒ¼</span><span>ãƒ‘ã‚¹æ•°</span><span>D% / R%</span></div>
      ${sorted.map(s=>{const dp=s.d/s.t*100,rp=s.r/s.t*100,w=s.t/dmax*100,isJP=s.o==='JP',cut=isCut(s);const bT=hasQ?hlT(s.brand):s.brand,dT=hasQ?hlT(s.n):s.n;const coT=s.co?`<span class="co"> ${s.co}</span>`:'';const dn=s.n;const isPtn=isPartner(s);
      return`<div class="vol-row${isPtn?' partner-row':''}" onmouseenter="showTip(event,raw.find(x=>x.n==='${dn}'))" onmousemove="moveTip(event)" onmouseleave="hideTip()"><div class="vol-name"><span class="${isJP?'jp':'gl'}">${bT}</span>${isPtn?'<span class="partner-badge">æ¨å¥¨</span>':''}${catTag(s)}${coT}<span class="dom">${dT}</span></div><div class="bar-wrap"><div class="bar-inner" style="width:${Math.max(w,2)}%;opacity:${cut?.4:1}"><div class="bd" style="width:${dp}%;height:100%"></div><div class="br" style="width:${rp}%;height:100%"></div></div></div><div class="vol-total" style="${cut?'color:#ccc':''}">${fmt(s.t)}</div><div class="ratio-label"><span class="d-num" style="${cut?'color:#93c5fd':''}">${dp.toFixed(0)}%</span><span class="sep-slash">/</span><span class="r-num" style="${cut?'color:#fdba74':''}">${rp.toFixed(0)}%</span></div></div>`;}).join('')}
    </div>
    <div class="sc-section">
      <h2>ãƒã‚¸ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ãƒãƒƒãƒ—</h2>
      <div class="desc">æ¨ªè»¸: æ²è¼‰ã‚µã‚¤ãƒˆæ•°(115ä¸­)ã€‚ç¸¦è»¸: DIRECTç‡ã€‚â—ã‚µã‚¤ã‚º: ãƒ‘ã‚¹æ•°ã€‚ç·‘=æ¨å¥¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‚é»„=é…ä¿¡ç®¡ç†ã€‚ç ´ç·šæ =æ¨å¥¨ã‚¾ãƒ¼ãƒ³ã€‚è¶³åˆ‡ã‚ŠSSPã¯éè¡¨ç¤ºï¼ˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼é™¤ãï¼‰ã€‚</div>
      <div class="sc-ctrl">
        <button class="pill ${scFilter==='all'?'on':''}" onclick="setSCF('all')">å…¨SSP</button>
        <button class="pill ${scFilter==='jp'?'on':''}" onclick="setSCF('jp')">å›½ç”£ã®ã¿</button>
        <button class="pill ${scFilter==='gl'?'on':''}" onclick="setSCF('gl')">æµ·å¤–ã®ã¿</button>
      </div>
      <div class="sc-box"><div id="sc" style="width:100%;height:420px;"></div>
      <div class="sc-legend"><span><div class="ld" style="background:#10b981"></div>æ¨å¥¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼</span><span><div class="ld" style="background:#6366f1"></div>SSPï¼ˆæµ·å¤–ï¼‰</span><span><div class="ld" style="background:#e11d48"></div>SSPï¼ˆå›½ç”£ï¼‰</span><span><div class="ld" style="background:#f59e0b"></div>é…ä¿¡ç®¡ç†</span></div></div>
    </div>
    <div class="tbl-section"><h2>è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ«</h2><div class="tw"><table><thead><tr>
      ${th('t','#','c')}<th>SSPå</th><th>ads.txt</th>${th('d','Direct','r')}${th('r','Reseller','r')}${th('t','ãƒ‘ã‚¹æ•°','r')}${th('dpct','D/Ræ§‹æˆ')}${th('spo','è©•ä¾¡ã‚¹ã‚³ã‚¢','r')}<th class="c">æ²è¼‰æ•°<br><span style="font-size:.5rem;color:#ccc">/ ${TS}</span></th>
    </tr></thead><tbody>
    ${sorted.map((s,i)=>{const dp=s.d/s.t*100,rp=s.r/s.t*100,sc=spoScore(s),hb=hbScore(s),cut=isCut(s),oc='otag-'+(['JP','US','FR','UK','CA'].includes(s.o)?s.o:'o');const bT=hasQ?hlT(s.brand):s.brand,dT=hasQ?hlT(s.n):s.n;const isPtnTbl=isPartner(s);const coLabel=s.co?` <span style="font-size:.55rem;color:#bbb">${s.co}</span>`:'';const dn=s.n;const isHB=CAT[s.n]==='hb';
    return`<tr style="${cut?'opacity:.5':''}" onmouseenter="showTip(event,raw.find(x=>x.n==='${dn}'))" onmousemove="moveTip(event)" onmouseleave="hideTip()"><td class="c" style="color:#ccc;font-size:.66rem;font-family:'IBM Plex Mono',monospace">${i+1}</td><td class="nm">${bT}<span class="otag ${oc}">${s.o}</span>${catTag(s)}${coLabel}${cut?'<span class="cut-badge">&lt;1K</span>':''}${isPtnTbl?'<span class="partner-badge">æ¨å¥¨</span>':''}</td><td style="font-size:.66rem;color:#aaa;font-family:'IBM Plex Mono',monospace">${dT}</td><td class="r" style="color:#3b82f6">${fmt(s.d)}</td><td class="r" style="color:#f97316">${fmt(s.r)}</td><td class="r" style="font-weight:600">${fmt(s.t)}</td><td><div style="display:flex;align-items:center;gap:4px"><div class="mini-bar" style="width:${Math.max(28,s.t/dmax*80)}px"><div class="bd" style="width:${dp}%;height:100%"></div><div class="br" style="width:${rp}%;height:100%"></div></div><span class="ratio-label" style="font-size:.68rem"><span class="d-num">${dp.toFixed(0)}%</span><span class="sep-slash">/</span><span class="r-num">${rp.toFixed(0)}%</span></span></div></td><td class="r" style="font-weight:600;color:${isHB?'#d97706':sc===null?'#ddd':sc>=50?'#16a34a':sc>=35?'#555':'#aaa'}">${isHB?'<span style=\"font-size:.56rem\">å°å…¥</span>'+Math.round(hb)+'%':sc===null?'â€”':sc.toFixed(1)}</td><td class="c"><span style="font-size:.72rem;color:#555;font-family:'IBM Plex Mono',monospace">${s.s}</span><span style="font-size:.56rem;color:#ccc"> / ${TS}</span></td></tr>`;}).join('')}
    </tbody></table></div></div>
    <div class="ft">
      <strong>SSPè©•ä¾¡ã‚¹ã‚³ã‚¢:</strong> ã‚«ãƒãƒ¬ãƒƒã‚¸(30%) + DIRECTç‡(35%) + (ã‚¹ã‚±ãƒ¼ãƒ«Ã—DIRECTç‡)(35%)ã€‚<strong>SSPã‚«ãƒ†ã‚´ãƒªã®ã¿</strong>ã«é©ç”¨ã€‚1,000ãƒ‘ã‚¹æœªæº€ã¯å¯¾è±¡å¤–ã€‚ãƒãƒ¼ã‚¸ãƒ³ç‡ã‚„CPMã¯å«ã¾ãªã„ã€‚<br>
      <strong>ã‚«ãƒ†ã‚´ãƒªåˆ†é¡ã®ç†ç”±:</strong> é…ä¿¡ç®¡ç†å‹ï¼ˆfluct, Ad Generation, i-mobile, AJA SSPï¼‰ã¯ãƒ¡ãƒ‡ã‚£ã‚¢å´ã§SSPã‚’ã¾ã¨ã‚ã‚‹å½¹å‰²ã‚’æ‹…ã£ã¦ãŠã‚Šã€ä»–SSPçµŒç”±ã®çµŒè·¯ãŒå¤šã„ãŸã‚ãƒªã‚»ãƒ©ãƒ¼æ¯”ç‡ãŒæ§‹é€ çš„ã«é«˜ããªã‚‹ã€‚å“è³ªã®å•é¡Œã§ã¯ãªããƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã®é•ã„ã€‚SSPã¨åŒã˜ã‚¹ã‚³ã‚¢ã§ã¯ãƒ•ã‚§ã‚¢ã§ãªã„ãŸã‚ã€Œå°å…¥ç‡ã€ã§åˆ¥è©•ä¾¡ã€‚<br>
      <strong>è¶³åˆ‡ã‚Š(SSPã‚«ãƒ†ã‚´ãƒªå†…):</strong> Teads(660) Geniee SSP(463) MicroAd COMPASS(428) Ogury(295)<br>
      <strong>å›½ç”£SSP:</strong> fluctâ†’CARTA HD ï½œ Ad Generationâ†’Supership(KDDI) ï½œ AJA SSPâ†’CA ï½œ i-mobileâ†’ç‹¬ç«‹ç³»<br><strong>é™¤å¤–SSP(5ç¤¾):</strong> Criteoï¼ˆè‡ªç¤¾DSPå„ªä½ï¼‰/ Outbrainãƒ»Taboolaï¼ˆãƒã‚¤ãƒ†ã‚£ãƒ–ADNWï¼‰/ DAC/adingoãƒ»YieldOneï¼ˆåšå ±å ‚DYã‚°ãƒ«ãƒ¼ãƒ—ï¼ç«¶åˆï¼‰
    </div>`;
  const inp=document.getElementById('si');if(inp&&searchQ)inp.value=searchQ;
  renderSC(scData,top3ids,top5ids);
}
function renderGC(gt){
  let h='<div class="gcards">';
  for(let[gn,gv]of Object.entries(gt)){const gc=grps[gn],dp=(gv.d/gv.t*100).toFixed(1);h+=`<div class="gc" style="border-color:${gc.bc}"><div class="gn"><div class="dot" style="background:${gc.c}"></div>${gn}</div><div class="gd">åˆç®—: <b>${fmt(gv.t)}</b>ãƒ‘ã‚¹ï¼ˆD:<b>${fmt(gv.d)}</b> R:<b>${fmt(gv.r)}</b>ï¼‰DIRECTç‡:<b>${dp}%</b> / æ²è¼‰: <b>${gv.s}</b>ã‚µã‚¤ãƒˆ</div><div class="gm">${gv.ms.join(' + ')}</div></div>`;}
  return h+'</div>';
}
function renderSC(scData,top3ids,top5ids){
  const el=document.getElementById('sc');if(!el)return;
  const W=el.clientWidth,H=el.clientHeight,pa={l:46,r:16,t:14,b:34},pw=W-pa.l-pa.r,ph=H-pa.t-pa.b,sMax=Math.max(...scData.map(x=>x.t),1),hasQ=!!searchQ;
  const sVals=scData.map(x=>x.s),sMin=Math.min(...sVals)-1,sRange=Math.max(...sVals)-sMin+1;
  let svg=`<svg width="${W}" height="${H}" style="display:block"><rect x="${pa.l}" y="${pa.t}" width="${pw}" height="${ph}" fill="#fafafa" rx="4"/>`;
  for(let v of[.25,.5,.75]){svg+=`<line x1="${pa.l+v*pw}" y1="${pa.t}" x2="${pa.l+v*pw}" y2="${pa.t+ph}" stroke="#eee"/><line x1="${pa.l}" y1="${pa.t+(1-v)*ph}" x2="${pa.l+pw}" y2="${pa.t+(1-v)*ph}" stroke="#eee"/>`;}
  svg+=`<line x1="${pa.l}" y1="${pa.t+ph}" x2="${pa.l+pw}" y2="${pa.t+ph}" stroke="#ddd"/><line x1="${pa.l}" y1="${pa.t}" x2="${pa.l}" y2="${pa.t+ph}" stroke="#ddd"/>`;
  svg+=`<text x="${pa.l+pw/2}" y="${H-4}" text-anchor="middle" fill="#bbb" font-size="9.5" font-family="IBM Plex Mono">${TS}ã‚µã‚¤ãƒˆä¸­ã®æ²è¼‰æ•°</text>`;
  svg+=`<text x="8" y="${pa.t+ph/2}" text-anchor="middle" fill="#bbb" font-size="9.5" font-family="IBM Plex Mono" transform="rotate(-90,8,${pa.t+ph/2})">DIRECTç‡</text>`;
  for(let v of[0,.5,1]){svg+=`<text x="${pa.l+v*pw}" y="${pa.t+ph+14}" text-anchor="middle" fill="#ddd" font-size="8" font-family="IBM Plex Mono">${Math.round(sMin+v*sRange)}</text><text x="${pa.l-4}" y="${pa.t+(1-v)*ph+3}" text-anchor="end" fill="#ddd" font-size="8" font-family="IBM Plex Mono">${Math.round(v*100)}%</text>`;}
  // Partner recommended zone
  const ptnData=scData.filter(s=>isPartner(s));
  if(ptnData.length>=2){
    const pxs=ptnData.map(s=>pa.l+((s.s-sMin)/sRange)*pw);
    const pys=ptnData.map(s=>pa.t+(1-s.d/s.t)*ph);
    const zx1=Math.min(...pxs)-28,zx2=Math.max(...pxs)+28,zy1=Math.min(...pys)-28,zy2=Math.max(...pys)+28;
    svg+=`<rect x="${zx1}" y="${zy1}" width="${zx2-zx1}" height="${zy2-zy1}" rx="10" fill="rgba(16,185,129,.06)" stroke="#10b981" stroke-width="1.5" stroke-dasharray="6,3"/>`;
    svg+=`<text x="${zx2-4}" y="${zy1+13}" text-anchor="end" fill="#10b981" font-size="8.5" font-weight="600" font-family="IBM Plex Mono">æ¨å¥¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼</text>`;
  }
  const labels=[];
  for(const s of scData){
    const cx=pa.l+((s.s-sMin)/sRange)*pw,cy=pa.t+(1-s.d/s.t)*ph,r=Math.max(5,Math.min(22,Math.sqrt(s.t/sMax)*22));
    const cut=isCut(s),isM=mq(s);
    const isPtnSC=isPartner(s);const isHBsc=CAT[s.n]==='hb';let fill=cut?'#ccc':isPtnSC?'#10b981':isHBsc?'#f59e0b':s.o==='JP'?'#e11d48':'#6366f1';
    let op=hasQ?(isM?.8:.08):.55,sw=isPtnSC?2.5:1.2,sc=isPtnSC?'#10b981':'white';
    if(hasQ&&isM){op=.8;sw=2.5;sc='#10b981';}
    svg+=`<circle cx="${cx}" cy="${cy}" r="${r}" fill="${fill}" opacity="${op}" stroke="${sc}" stroke-width="${sw}"/>`;
    let lbl=s.brand;if(lbl.length>16)lbl=lbl.substring(0,14)+'â€¦';
    const showLabel=!hasQ||(hasQ&&isM);
    if(showLabel){let lx=cx+r+4,anc='start';if(lx+70>pa.l+pw){lx=cx-r-4;anc='end';}
    labels.push({x:lx,y:cy+3,t:lbl,a:anc,oy:cy,op:hasQ?(isM?1:.06):1,fw:isPtnSC?'700':'400',lc:isPtnSC?'#059669':isHBsc?'#b45309':s.o==='JP'?'#c1121f':'#555'});}
  }
  labels.sort((a,b)=>a.oy-b.oy);for(let i=1;i<labels.length;i++){if(Math.abs(labels[i].y-labels[i-1].y)<11)labels[i].y=labels[i-1].y+11;}
  for(const lb of labels)svg+=`<text x="${lb.x}" y="${lb.y}" text-anchor="${lb.a}" fill="${lb.lc}" font-size="9" font-family="IBM Plex Mono" font-weight="${lb.fw}" opacity="${lb.op}">${lb.t}</text>`;
  svg+='</svg>';el.innerHTML=svg;
}
let sT=null;
function doSearch(v){searchQ=v;clearTimeout(sT);sT=setTimeout(()=>render(),180);}
function setF(f){filter=f;searchQ='';render();}
function tgGrp(){showGrp=!showGrp;render();}
function setSCF(f){scFilter=f;render();}
function doSort(k){if(tblSort===k)tblDir*=-1;else{tblSort=k;tblDir=-1;}render();}
render();window.addEventListener('resize',render);
</script>
</body>
</html>
